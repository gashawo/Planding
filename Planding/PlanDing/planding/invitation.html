<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>PlanDing - Registration</title>
    <link rel="stylesheet" href="css\bootstrap.min.css">
    <link href="css/gijgo.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="css\all.css">
    <link rel="stylesheet" href="css\main.css">
    <link href="https://fonts.googleapis.com/css?family=Dancing+Script&display=swap" rel="stylesheet">
    <style>
        #couple-name,
        #couple-name-small{
            font-family: 'Dancing Script', cursive;
            text-transform: capitalize;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-transparent shadow-sm">
            <a class="navbar-brand" href="#"><img src="images/logo.png" alt=""></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" id="logout">התנתק</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="album.html" id="albumLink"> אלבום</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="board.html" id="boardLink">לוח טרמפים</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="reports.html">דוחות</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="todo.html">רשימת מטלות</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="table_management.html"> סידורי הושבה</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link" href="manage_guest.html"> רשימת מוזמנים</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="event_create.html"> יצירת/עדכון אירוע</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="dashboard.html">בית<span class="sr-only">(current)</span></a>
                    </li>
                </ul>
            </div>
        </nav>
    <section id="invite-cover" class="p-md-5">
        <div class="row h-100">
            <div class="col-sm-12 col-lg-6 offset-lg-3 my-auto">
                <div class="card bg-transparent border-0 text-white">
                    <div class="card-header border-0 text-center text-uppercase font-weight-regular">
                        <h1 class="display-3 d-none d-md-block" id="couple-name"> שם הזוג</h1>
                        <h1 class="d-sm-block d-md-none" id="couple-name-small">
                            Ab
                        </h1>
                    </div>
                    <div class="card-body">
                        <div class="text-center">
                            <h5 id="date"></h5>
                            <i class="far fa-heart mt-lg-3 mb-lg-3"></i>
                            <h2 class="font-italic mt-lg-3 mb-lg-3">Save The Date</h2>
                        </div>
                        <div class="row" style="font-size:1.6em">
                            <div class="col-sm-6 text-center">
                                <strong> שעת קבלת פנים</strong><br>
                                <p id="receotionTime"></p>
                            </div>
                            <div class="col-sm-6 text-center">
                                <strong> שעת חופה וקידושין</strong><br>
                                <p id="ceremonyTime"></p>
                            </div>
                            <div class="col-sm-12 text-center" id="place">

                            </div>
                            
                            <div class="col-sm-12 text-center">
                                <h4>?אתה מתכוון להגיע</h4>
                                <!--This values used while redirect-->
                                <button class="btn btn-success" id="coming" value="1"><i class="fas fa-check mr-3"></i> ברור שכן</button>
                                <button class="btn btn-danger" id="not_coming" value="0"><i class="fas fa-times mr-3"></i>לצערי לא</button>
                                <br>
                                <small>
                                    <a id="boardLink2">מעוניין להציע/לחפש טרמפ </a> &emsp; &emsp;&emsp;&emsp;
                                    <a id="albumLink2" class="ml-2">רוצה מזכרת? העלה תמונה</a>
                                </small>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/sweetalert.min.js"></script>
    <script src="js/gijgo.min.js" type="text/javascript"></script>


    <script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-database.js"></script>

    <script src="js/main.js"></script>

    <script src="js/firebase.js"></script>

    <script>
        firebase.initializeApp(firebaseConfig);

        var getUrlParameter = function getUrlParameter(sParam) {
            var sPageURL = window.location.search.substring(1),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
                }
            }
        };
        //Check Param
        userid = getUrlParameter("user");


        //Details show in their relative space
        function setEventDetail(details) {
            $("#couple-name").html(details.groomName + "<i class='far fa-heart ml-3 mr-3'></i>" + details.brideName);
            $("#couple-name-small").html(details.groomName + "<i class='far fa-heart ml-3 mr-3'></i>" + details.brideName);

            $("#date").html(details.weddingDate);
            $("#receotionTime").html(details.receotionTime);
            $("#ceremonyTime").html(details.ceremonyTime);
            $("#place").html(details.weddingPlace);
            if(details.image)
                $("#invite-cover").css("background","url('"+details.image+"'), #00000099 no-repeat center center fixed")

            $("#albumLink2").attr("href","uploadAlbum.html?user="+userid)
            $("#boardLink2").attr("href","board.html?user="+userid)
        }

        $(document).ready(function () {
            if (userid) {
                var database = firebase.database();
                $("#boardLink").attr("href","board.html?user="+userid);
                $("#albumLink").attr("href","album.html?user="+userid);
                database.ref("users/" + userid + "/event/eventDetail").once('value').then(function (snapshot) {
                    setEventDetail(snapshot.val());
                });
            }
            else {
                swal({
                    title: "!!!אופס",
                    text: "לא מצאנו אירוע במערכת",
                    icon: "error"
                }).then(function () {
                    redirectToDashboard();
                })
            }
            //For comming val return 1 and not coming val return 0.
            //Redirect based on button click with userid
            $("#coming,#not_coming").click(function(){
                window.location.href="coming_form.html?user="+userid+"&isComming="+$(this).val();
            });
        });
    </script>
</body>

</html>